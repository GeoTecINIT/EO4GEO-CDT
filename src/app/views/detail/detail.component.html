<div class="animated fadeIn">
  <div class="row">
    <div class="col-sm-12 col-md-12">
      <div class="card card-accent-primary">
        <div class="card-header">
          <div class="row">
            <div class="col-sm-4 col-md-2">
              Detail
            </div>
            <div class="col-sm-4 offset-md-4 col-md-4"></div>
            <div class="col-sm-4 col-md-2">
              <div *ngIf="selectedProgram; else loading" class="row">
                <div class="cols-xs-2 col-md-3">
                  <button type="button" class="btn btn-block btn-link" [popover]="popTemplate" tooltip="Share"
                    popoverTitle="Copy link, export to PDF or XML" placement="top" [outsideClick]="true">
                    <i class="fa fa-share-alt fa-lg"></i>
                  </button>
                </div>
                <div class="cols-xs-2 col-md-3">
                  <button type="button" class="btn btn-block btn-link" tooltip="Duplicate"
                    routerLink="/newsp/duplicate/{{ selectedProgram._id }}">
                    <i class="fa fa-copy fa-lg"></i>
                  </button>
                </div>
                <div class="cols-xs-2 col-md-3">
                  <button type="button" class="btn btn-block btn-link" tooltip="Edit"
                    routerLink="/newsp/copy/{{ selectedProgram._id }}">
                    <i class="fa fa-edit fa-lg"></i>
                  </button>
                </div>
                <div class="cols-xs-2 col-md-3">
                  <button type="button" class="btn btn-block btn-link" tooltip="Remove" data-toggle="modal"
                    (click)="dangerModal.show()">
                    <i class="fa fa-trash-o fa-lg"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="card-body">
          <ng-container> <!--  *ngIf="selectedProgram; else loading" -->
            <div class="row">
              <div class="col-md-6">
                <h1>{{ selectedProgram.name }}</h1>
                <h5>{{ selectedProgram.affiliation }} </h5>
              </div>
              <div class="col-md-2 offset-md-3">
                <!--    <h5>{{ selectedProgram.field.name }} ({{ selectedProgram.field.grandparent }})</h5> -->

              </div>
              <div class="col-md-1">
                <button type="button" class="btn btn-default btn-secondary"
                  tooltip="The threshold of knowledge by which a person is capable to understand the information given in a certain domain."
                  placement="left" (click)="displayTree()">
                  {{ selectedProgram.level }}
                </button>
              </div>
            </div>
            <!--  <p>{{ selectedProgram.description }}</p> -->
            <!-- <hr />
            <div class="row">
              <div class="col-md-4">
                <label>Knowledge</label>
                <span
                  tooltip="The occupational profile knowledge represent the comprehensive awareness in certain areas/domains, which complete the list of theoretical capacity learning."
                  class="badge badge-primary badge-pill">i</span>
              </div>
            </div>
            <div class="row text-center">
              <div class="col-md-8">
                <button *ngFor="let mk of selectedProgram.knowledge" type="button" class="btn btn-pill"
                  [ngClass]="'bok-' + ( mk | slice:1:3 )">
                  {{ mk }}
                </button>
              </div>
              <div class="col-md-4">
                <p><small class="text-muted"> Knowledge distribution </small></p>
                <div *ngFor="let k of statistics" class="row">
                  <div class="col-md-2">
                    <div class="float-right">
                      <small class="text-muted"> [{{k.code}}] {{k.value}}% </small>
                    </div>
                  </div>
                  <div class="col-md-8">
                    <div class="progress progress-xs">
                      <div class="progress-bar" [ngClass]="'bok-' + k.code" role="progressbar" aria-valuenow="k.value"
                        [style.width.%]="k.value" aria-valuemin="0" aria-valuemax="100"></div>
                    </div>
                  </div>
                </div>
              </div>
            </div> -->

            <div class="row">
              <div class="col-md-6" #graphTreeDiv>
                <div class="card card-accent-secondary">
                  <div class="card-header">
                    <label>General view</label>
                    <span tooltip="Click on any node to see more information about the module, course or lecture."
                      class="badge badge-primary badge-pill">i</span>
                    <button class="btn btn-link float-right pull-right"
                      (click)="graphTreeDiv.classList.contains('col-md-12') ? graphTreeDiv.className = 'col-md-6' : graphTreeDiv.className = 'col-md-12'">
                      <!--    [ngClass]="'active' : shown == 'EQUIFAX'" (click)="shown = 'EQUIFAX'" type="button" id="equifax" class="btn btn-secondary" -->
                      <i class="float-right pull-right fa "
                        [ngClass]="{'fa-window-minimize': graphTreeDiv?.classList.contains('col-md-12'), 'fa-window-maximize': graphTreeDiv?.classList.contains('col-md-6')}"></i>
                    </button>
                    <div id="graphTree"></div>
                  </div>
                </div>
              </div>

              <!--   <ng-container *ngIf="selectedItem">
                <div class="col-md-6">
                  <div class="card card-accent-secondary">
                    <div class="card-header">
                      <button type="button" class="btn btn-ghost-primary" (click)="deselectItem()">
                        <- Back </button> <label>Selected item info</label>
                          <hr>
                          <div class="card-body">
                            <h4 class="card-title">{{ selectedItem.name }}</h4>
                            <h6 class="card-subtitle mb-2 text-muted">Semester {{ selectedItem.numSemester }}</h6>
                            <div *ngIf="selectedItem.prerequisites">
                              <hr>
                              <h5 class="card-title">Prerequisites</h5>
                              <button *ngFor="let child of selectedItem.prerequisites" type="button"
                                class="btn btn-pill btn-light">
                                {{ child.conceptId }} - {{ child.name }}
                              </button>
                            </div>
                            <div *ngIf="selectedItem.learningObjectives">
                              <hr>
                              <h5 class="card-title">Learning Outcomes</h5>
                              <button *ngFor="let child of selectedItem.learningObjectives" type="button"
                                class="btn btn-pill btn-light">
                                {{ child.conceptId }} - {{ child.name }}
                              </button>
                            </div>
                            <div *ngIf="selectedItem.courses">
                              <hr>
                              <h5 class="card-title">Courses included</h5>
                              <div class="row">
                                <div *ngFor="let c of selectedItem.courses">
                                  <div class="col-sm-6">
                                    <div class="card" style="width: 18rem;">
                                      <div class="card-body">
                                        <h5 class="card-title">{{ c.name }}</h5>
                                        <button type="button" class="btn btn-ghost-primary"
                                          (click)="selectItem(c._id, 'courses')">Show more... </button>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                            <div *ngIf="selectedItem.lectures">
                              <hr>
                              <h5 class="card-title">Lectures included</h5>
                              <div class="row">
                                <div *ngFor="let l of selectedItem.lectures">
                                  <div class="col-sm-6">
                                    <div class="card" style="width: 18rem;">
                                      <div class="card-body">
                                        <h5 class="card-title">{{ l.name }}</h5>
                                        <button type="button" class="btn btn-ghost-primary"
                                          (click)="selectItem(l._id, 'lectures')">Show more... </button>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                    </div>
                  </div>
                </div>
              </ng-container>

 -->

              <div class="col-md-6">

                <accordion [isAnimated]="true">

                  <!--     <accordion-group #groupGI [isOpen]="true">
                    <button class="btn btn-link btn-block clearfix" accordion-heading>
                      <div class="pull-left float-left">I can have markup!</div>
                      <i class="float-right pull-right fa"
                        [ngClass]="{'fa-caret-down': groupGI?.isOpen, 'fa-caret-up': !groupGI?.isOpen}"></i>
                    </button>
                    This is just some content to illustrate fancy headings.
                  </accordion-group>
                  <accordion-group>
                    <button class="btn btn-link" accordion-heading>
                      I can have markup, too!
                    </button>
                    <span class="badge badge-secondary center">And some HTML here</span>
                  </accordion-group> -->

                  <accordion-group #groupGI class="card card-accent-secondary" [isOpen]="true">
                    <button class="btn btn-link btn-block clearfix" accordion-heading>
                      <div class="pull-left float-left">General Info</div>
                      <i class="float-right pull-right fa"
                        [ngClass]="{'fa-caret-down': groupGI?.isOpen, 'fa-caret-up': !groupGI?.isOpen}"></i>
                    </button>
                    <h5>{{ selectedProgram.affiliation }}</h5>
                    <h6>{{ selectedProgram.field }}</h6>
                    <p class="card-text">{{ selectedProgram.description }}</p>
                  </accordion-group>

                  <div *ngIf="selectedItem && selectedItem.modules">
                    <accordion-group #groupMod class="card card-accent-secondary" [isOpen]="true">
                      <button class="btn btn-link btn-block clearfix" accordion-heading>
                        <div class="pull-left float-left">Modules</div>
                        <i class="float-right pull-right fa"
                          [ngClass]="{'fa-caret-down': groupMod?.isOpen, 'fa-caret-up': !groupMod?.isOpen}"></i>
                      </button>
                      <div class="row">
                        <div *ngFor="let m of selectedProgram.modules">
                          <div class="col-sm-6">
                            <div class="card" style="width: 18rem;">
                              <div class="card-body">
                                <h5 class="card-title">{{ m.name }}</h5>
                                <!--          <h6 class="card-subtitle mb-2 text-muted">{{ m.numSemester }} semester</h6>
                                <p class="card-text">{{ m.description }}</p> -->
                                <button type="button" class="btn btn-ghost-primary"
                                  (click)="selectItem(m._id, 'modules')">Show more... </button>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </accordion-group>
                  </div>

                  <div *ngIf="selectedItem && selectedItem.courses">
                    <accordion-group #groupCou class="card card-accent-secondary" [isOpen]="true">
                      <button class="btn btn-link btn-block clearfix" accordion-heading>
                        <div class="pull-left float-left">Courses</div>
                        <i class="float-right pull-right fa"
                          [ngClass]="{'fa-caret-down': groupCou?.isOpen, 'fa-caret-up': !groupCou?.isOpen}"></i>
                      </button>
                      <div class="row">
                        <div *ngFor="let c of selectedItem.courses">
                          <div class="col-sm-6">
                            <div class="card" style="width: 18rem;">
                              <div class="card-body">
                                <h5 class="card-title">{{ c.name }}</h5>
                                <button type="button" class="btn btn-ghost-primary"
                                  (click)="selectItem(c._id, 'courses')">Show more... </button>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </accordion-group>
                  </div>

                  <div *ngIf="selectedItem && selectedItem.lectures">
                    <accordion-group #groupCou class="card card-accent-secondary" [isOpen]="true">
                      <button class="btn btn-link btn-block clearfix" accordion-heading>
                        <div class="pull-left float-left">Lectures</div>
                        <i class="float-right pull-right fa"
                          [ngClass]="{'fa-caret-down': groupCou?.isOpen, 'fa-caret-up': !groupCou?.isOpen}"></i>
                      </button>
                      <div class="row">
                        <div *ngFor="let l of selectedItem.lectures">
                          <div class="col-sm-6">
                            <div class="card" style="width: 18rem;">
                              <div class="card-body">
                                <h5 class="card-title">{{ l.name }}</h5>
                                <button type="button" class="btn btn-ghost-primary"
                                  (click)="selectItem(l._id, 'lectures')">Show more... </button>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </accordion-group>
                  </div>
                </accordion>
              </div>


              <!-- <ng-container *ngIf="!selectedItem">
                <div class="col-md-6">
                  <div class="card card-accent-secondary">
                    <div class="card-header">
                      <h5 class="card-title">Modules included</h5>
                      <div class="row">
                        <div *ngFor="let m of selectedProgram.modules">
                          <div class="col-sm-6">
                            <div class="card" style="width: 18rem;">
                              <div class="card-body">
                                <h5 class="card-title">{{ m.name }}</h5>
                                          <h6 class="card-subtitle mb-2 text-muted">{{ m.numSemester }} semester</h6>
                                <p class="card-text">{{ m.description }}</p> 
                                <button type="button" class="btn btn-ghost-primary"
                                  (click)="selectItem(m._id, 'modules')">Show more... </button>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                    <div class="col-md-2">
                  <div class="card card-accent-secondary">
                    <div class="card-header">
                      <label>Courses</label>
                      <span tooltip="Modules are in the top level of the study program"
                        class="badge badge-primary badge-pill">i</span>
                      <button *ngFor="let ms of selectedProgram.modules | keyvalue" type="button"
                        class="btn btn-pill btn-light" (click)="selectItem(ms.key, 'courses')">
                        {{ ms.name }} - {{ ms._id }}
                      </button>
                    </div>
                  </div>
                </div>
                <div class="col-md-2">
                  <div class="card card-accent-secondary">
                    <div class="card-header">
                      <label>Lectures</label>
                      <span tooltip="Modules are in the top level of the study program"
                        class="badge badge-primary badge-pill">i</span>
                      <button *ngFor="let ms of selectedProgram.modules | keyvalue" type="button"
                        class="btn btn-pill btn-light" (click)="selectItem(ms.key, 'lectures')">
                        {{ ms.name }} - {{ ms._id }}
                      </button>
                    </div>
                  </div>
                </div> 
              </ng-container>
 -->





              <div class="row text-center">
                <div class="col-md-12">

                </div>
              </div>
            </div>

            <!--  <div class="row text-center">
              <div class="col-md-12">
                <button *ngFor="let mc of selectedProfile.competences" type="button" class="btn btn-pill btn-primary">
                  {{ mc.preferredLabel }}
                </button>
              </div>
            </div> -->
          </ng-container>
          <ng-template #loading>
            <app-loading-indicator></app-loading-indicator>
          </ng-template>
        </div>
      </div>
    </div>
    <!--/.col-->
  </div>
  <!--/.row-->
</div>
<ng-template #popTemplate>
  <app-popup idOP="{{selectedProgram._id}}"></app-popup>
</ng-template>
<div bsModal #dangerModal="bs-modal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
  aria-hidden="true">
  <div class="modal-dialog modal-danger" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title">Are you sure you want to delete this Occupational Profile?</h4>
        <button type="button" class="close" (click)="dangerModal.hide()" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <p>After you delete it it won't be accessible to anyone.</p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-primary" (click)="dangerModal.hide()">Close</button>
        <button type="button" class="btn btn-danger"
          (click)="studyprogramService.removeStudyProgram(selectedProgram._id)" routerLink="/list">Delete</button>
      </div>
    </div><!-- /.modal-content -->
  </div><!-- /.modal-dialog -->
</div><!-- /.modal -->